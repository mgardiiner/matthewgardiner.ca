import{_ as ie}from"./DQu6aDY2.js";import{g as de,r as C,m as v,p as ce,c as r,a as t,j as m,l as b,v as ue,z as me,A as pe,t as f,B as V,w as O,F as h,C as y,o as a,d as xe,k as H,q as j,y as E}from"./DDdGTNQA.js";import{u as fe}from"./DatrwkiE.js";import{u as ve}from"./DlcP7OL2.js";import{u as ge}from"./CDZBQwIF.js";import"./B-RZKRZT.js";import"./CLStg_Nh.js";const be={class:"min-h-screen bg-gradient-to-b from-slate-950 via-slate-900 to-slate-950 text-slate-100"},he={class:"max-w-6xl mx-auto px-4 pb-12 pt-4 space-y-8"},ye={class:"flex items-center justify-between"},_e={class:"flex items-center gap-3"},we={key:0,class:"relative w-full overflow-hidden rounded-3xl border border-slate-800 bg-slate-900/80 min-h-[220px]"},ke={class:"absolute inset-0 overflow-hidden"},Ne=["alt"],Ce={class:"relative z-10 flex flex-col sm:flex-row items-center sm:items-end px-5 py-6 gap-4"},Le={class:"flex-1 space-y-3"},Se={class:"text-2xl sm:text-3xl font-bold leading-tight max-w-xl"},Re={class:"flex flex-wrap gap-2 pt-1"},Me={class:"hidden sm:block w-28 h-40 rounded-2xl overflow-hidden border border-slate-700 shadow-lg"},Be=["alt"],je={key:1,class:"text-red-400 text-sm"},Ee={key:2,class:"space-y-2"},Fe={class:"relative -mx-4 px-4"},Ae={class:"flex gap-2 overflow-x-hidden pb-2"},Ie={key:3,class:"space-y-2"},Te={class:"relative -mx-4 px-4"},ze={class:"flex gap-2 overflow-x-auto pb-2 scrollbar-thin scrollbar-thumb-slate-700 scrollbar-track-slate-900"},De={class:"relative rounded-xl overflow-hidden bg-slate-900 border border-slate-800 transition-transform duration-200 group-hover:-translate-y-1 group-hover:border-sky-500/70"},Ve=["alt"],Oe={key:1,class:"w-full h-[180px] sm:h-[200px] md:h-[220px] bg-slate-800 flex items-center justify-center text-slate-500 text-[10px]"},We=["onClick"],Ge={class:"mt-1.5 space-y-0.5"},Pe={class:"text-[11px] font-medium leading-snug line-clamp-2 text-slate-50"},$e={key:4,class:"space-y-6"},Ue={class:"relative -mx-4 px-4"},qe={class:"flex gap-2 overflow-x-hidden pb-2"},Ke={key:5,class:"space-y-6"},Ye={class:"flex items-baseline justify-between"},Qe={class:"text-base font-semibold"},Xe={class:"text-[11px] text-slate-500"},Ze={class:"relative -mx-4 px-4"},He={class:"flex gap-2 overflow-x-auto pb-2 scrollbar-thin scrollbar-thumb-slate-700 scrollbar-track-slate-900"},Je={class:"relative rounded-xl overflow-hidden bg-slate-900 border border-slate-800 transition-transform duration-200 group-hover:-translate-y-1 group-hover:border-sky-500/70"},et=["alt"],tt={key:1,class:"w-full h-[180px] sm:h-[200px] md:h-[220px] bg-slate-800 flex items-center justify-center text-slate-500 text-[10px]"},st=["onClick"],ot={class:"mt-1.5 space-y-0.5"},at={class:"text-[11px] font-medium leading-snug line-clamp-2 text-slate-50"},lt={key:6,class:"text-slate-400 text-sm"},xt=de({__name:"index",setup(rt){const{categories:J,rows:F,loadFromCache:ee}=fe(),{isFavourite:W,toggleFavourite:G,favs:P}=ve(),{recentIds:L}=ge(),_=C(!1),S=C(null),w=C(""),A=C("newest"),R=C(!0),te=["SOCCER","DE -","BE -","PT/BR -","ES -","FR -","LA -","AF -","QC -","IT -","NL -","GR -","NORDIC","SVENSKA","DANSKE","NORGE","MT -","BG -","AL -","EX -","TR -","IR -","SO -","IN -","BN -","PK -","BR -","PL -","EN - ITALIAN SUB ENG"].map(o=>o.toLowerCase()),se=o=>{const e=o.toLowerCase();return te.some(l=>e.startsWith(l))},oe=v(()=>J.value.filter(o=>!se(o.category_name))),g=v(()=>{if(!F.value.length)return[];const o=new Set(oe.value.map(s=>s.category_id)),e=F.value.filter(s=>o.has(s.category.category_id)),l=e.filter(s=>s.category.category_name.trim().toLowerCase().startsWith("en -")),d=e.filter(s=>!s.category.category_name.trim().toLowerCase().startsWith("en -"));return[...l,...d]}),M=v(()=>{for(const o of g.value)if(o.movies.length>0)return o.movies[0];return null}),B=v(()=>M.value?.stream_icon||null),I=v(()=>M.value?.name??""),$=v(()=>M.value?.stream_id??null),U=o=>{if(!o)return null;const e=o.match(/\((\d{4})\)/);if(!e)return null;const l=Number(e[1]);return Number.isNaN(l)?null:l},p=o=>{if(typeof o.rating_5based=="number")return o.rating_5based*2;const e=Number(o.rating);return Number.isNaN(e)?0:e},q=o=>o>=8?"bg-emerald-100 text-emerald-700":o>=6?"bg-amber-100 text-amber-700":"bg-gray-100 text-gray-600",K=o=>{const e=Number(o.added);if(!Number.isNaN(e)&&e>0)return e;const l=U(o.name);return l?l*1e9:0},ae=o=>{const e=o.slice();switch(A.value){case"newest":e.sort((l,d)=>K(d)-K(l));break;case"rating":e.sort((l,d)=>p(d)-p(l));break;case"az":e.sort((l,d)=>(l.name||"").localeCompare(d.name||"",void 0,{sensitivity:"base"}));break}return e},Y=o=>{let e=o;if(w.value.trim()){const l=w.value.toLowerCase();e=e.filter(d=>d.name?.toLowerCase().includes(l))}return ae(e)},le=o=>{const e=new Map;for(const i of o)for(const n of i.movies)e.has(n.stream_id)||e.set(n.stream_id,{movie:n,category:i.category});const l=new Set(P.value),d=new Set(L.value),s=new Map,c=new Map,T=(i,n)=>{n&&i.set(n,(i.get(n)||0)+1)};for(const i of P.value){const n=e.get(i);n?.category?.category_id&&T(s,n.category.category_id)}for(const i of L.value){const n=e.get(i);n?.category?.category_id&&T(c,n.category.category_id)}const re=i=>!!i&&i.trim().toLowerCase().startsWith("en -"),X=Math.max(L.value.length,1),ne=new Date().getFullYear(),z=[];for(const[i,{movie:n,category:k}]of e.entries()){let u=0,N=p(n);if(N<0&&(N=0),N>10&&(N=10),u+=N/10*.35,l.has(i)&&(u+=.5),k?.category_id){const x=s.get(k.category_id)||0,D=c.get(k.category_id)||0;u+=Math.min(x*.15,.6),u+=Math.min(D*.1,.4)}if(d.has(i)){const x=L.value.indexOf(i),D=(X-x)/X;u+=D*.2}const Z=U(n.name);if(Z){const x=ne-Z;x<=1?u+=.4:x<=3?u+=.3:x<=5?u+=.2:x<=10?u+=.1:u-=.05}k?.category_name&&re(k.category_name)&&(u+=.1),!n.rating&&!n.stream_icon&&(u-=.1),u<0&&(u=0),z.push({movie:n,score:u})}return z.sort((i,n)=>n.score-i.score),z.map(i=>i.movie)},Q=v(()=>{if(!g.value.length)return[];const o=le(g.value),e=w.value.trim().toLowerCase();return(e?o.filter(d=>d.name?.toLowerCase().includes(e)):o).slice(0,24)});return ce(async()=>{_.value=!0,S.value=null,R.value=!0,await ee(),F.value.length||(S.value="No movie library synced yet. Go to the Dashboard and press “Sync Library”."),_.value=!1,R.value=!1}),(o,e)=>{const l=ie,d=pe("lazy");return a(),r("div",be,[t("div",he,[t("header",ye,[e[3]||(e[3]=t("div",null,[t("h1",{class:"text-3xl font-semibold tracking-tight"},"Movies"),t("p",{class:"text-sm text-slate-400 mt-1"}," Browse by service, EN categories, and smart suggestions. ")],-1)),t("div",_e,[b(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>w.value=s),type:"text",placeholder:"Search titles...",class:"bg-slate-900/80 border border-slate-700 rounded-full px-3 py-1.5 text-xs text-slate-100 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-sky-500 w-40 sm:w-56"},null,512),[[ue,w.value]]),b(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>A.value=s),class:"bg-slate-900/80 border border-slate-700 rounded-full px-3 py-1.5 text-xs text-slate-100 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-sky-500"},[...e[2]||(e[2]=[t("option",{value:"newest"},"Newest",-1),t("option",{value:"rating"},"Rating",-1),t("option",{value:"az"},"A–Z",-1)])],512),[[me,A.value]])])]),M.value?(a(),r("section",we,[t("div",ke,[B.value?b((a(),r("img",{key:0,alt:I.value,class:"w-full h-full object-cover opacity-40"},null,8,Ne)),[[d,B.value]]):m("",!0),e[4]||(e[4]=t("div",{class:"absolute inset-0 bg-gradient-to-r from-slate-950 via-slate-950/70 to-transparent"},null,-1))]),t("div",Ce,[t("div",Le,[e[6]||(e[6]=t("p",{class:"text-xs uppercase tracking-[0.2em] text-sky-300/80"},"Featured",-1)),t("h2",Se,f(I.value),1),e[7]||(e[7]=t("p",{class:"text-xs text-slate-300 max-w-md line-clamp-2"}," Click through for details and a launchable stream URL in your favourite external player. ",-1)),t("div",Re,[$.value?(a(),V(l,{key:0,to:`/iptv/movies/${$.value}`,class:"inline-flex items-center justify-center px-4 py-1.5 rounded-full bg-sky-600 hover:bg-sky-500 text-xs font-semibold text-white shadow-sm"},{default:O(()=>[...e[5]||(e[5]=[xe(" Open details ",-1)])]),_:1},8,["to"])):m("",!0)])]),t("div",Me,[B.value?b((a(),r("img",{key:0,alt:I.value,class:"w-full h-full object-cover"},null,8,Be)),[[d,B.value]]):m("",!0)])])])):m("",!0),S.value?(a(),r("p",je,f(S.value),1)):m("",!0),R.value?(a(),r("section",Ee,[e[9]||(e[9]=t("div",{class:"flex items-baseline justify-between"},[t("h3",{class:"text-base font-semibold"},"Suggested for you"),t("p",{class:"text-[11px] text-slate-500"},"Building suggestions…")],-1)),t("div",Fe,[t("div",Ae,[(a(),r(h,null,y(8,s=>t("div",{key:s,class:"flex-none w-[120px] sm:w-[140px] md:w-[160px]"},[...e[8]||(e[8]=[t("div",{class:"w-full h-[180px] sm:h-[200px] md:h-[220px] rounded-xl bg-slate-800/80 animate-pulse"},null,-1),t("div",{class:"mt-1.5 h-3 rounded bg-slate-800/80 animate-pulse"},null,-1)])])),64))])])])):m("",!0),!R.value&&Q.value.length?(a(),r("section",Ie,[e[11]||(e[11]=t("div",{class:"flex items-baseline justify-between"},[t("h3",{class:"text-base font-semibold"},"Suggested for you"),t("p",{class:"text-[11px] text-slate-500"}," Based on what you've watched and favourited ")],-1)),t("div",Te,[t("div",ze,[(a(!0),r(h,null,y(Q.value,s=>(a(),V(l,{key:s.stream_id,to:`/iptv/movies/${s.stream_id}`,class:"group flex-none w-[120px] sm:w-[140px] md:w-[160px]"},{default:O(()=>[t("div",De,[s.stream_icon?b((a(),r("img",{key:0,alt:s.name,class:"w-full h-[180px] sm:h-[200px] md:h-[220px] object-cover transition-transform duration-200 group-hover:scale-105"},null,8,Ve)),[[d,s.stream_icon]]):(a(),r("div",Oe," No Art ")),t("button",{type:"button",onClick:H(c=>j(G)(s.stream_id),["stop"]),class:"absolute top-1 right-1 z-10 rounded-full bg-slate-900/80 p-1 shadow border border-slate-700/80 hover:border-amber-400"},[t("span",{class:E(["text-[11px]",j(W)(s.stream_id)?"text-amber-400":"text-slate-400"])}," ★ ",2)],8,We),p(s)>0?(a(),r("div",{key:2,class:E(["absolute top-1 left-1 text-[10px] font-semibold px-1.5 py-0.5 rounded-full shadow",q(p(s))])}," ★ "+f(p(s).toFixed(1)),3)):m("",!0),e[10]||(e[10]=t("div",{class:"absolute inset-x-0 bottom-0 h-16 bg-gradient-to-t from-black/80 via-black/20 to-transparent pointer-events-none"},null,-1))]),t("div",Ge,[t("p",Pe,f(s.name),1)])]),_:2},1032,["to"]))),128))])])])):m("",!0),_.value&&!g.value.length?(a(),r("section",$e,[(a(),r(h,null,y(4,s=>t("div",{key:s,class:"space-y-2"},[e[13]||(e[13]=t("div",{class:"flex items-baseline justify-between"},[t("div",{class:"h-4 w-32 bg-slate-800/80 rounded animate-pulse"}),t("div",{class:"h-3 w-16 bg-slate-800/80 rounded animate-pulse"})],-1)),t("div",Ue,[t("div",qe,[(a(),r(h,null,y(8,c=>t("div",{key:c,class:"flex-none w-[120px] sm:w-[140px] md:w-[160px]"},[...e[12]||(e[12]=[t("div",{class:"w-full h-[180px] sm:h-[200px] md:h-[220px] rounded-xl bg-slate-800/80 animate-pulse"},null,-1),t("div",{class:"mt-1.5 h-3 rounded bg-slate-800/80 animate-pulse"},null,-1)])])),64))])])])),64))])):m("",!0),!_.value&&g.value.length?(a(),r("section",Ke,[(a(!0),r(h,null,y(g.value,s=>(a(),r("div",{key:s.category.category_id,class:"space-y-2"},[t("div",Ye,[t("h3",Qe,f(s.category.category_name),1),t("p",Xe,f(Y(s.movies).length)+" titles ",1)]),t("div",Ze,[t("div",He,[(a(!0),r(h,null,y(Y(s.movies),c=>(a(),V(l,{key:c.stream_id,to:`/iptv/movies/${c.stream_id}`,class:"group flex-none w-[120px] sm:w-[140px] md:w-[160px]"},{default:O(()=>[t("div",Je,[c.stream_icon?b((a(),r("img",{key:0,alt:c.name,class:"w-full h-[180px] sm:h-[200px] md:h-[220px] object-cover transition-transform duration-200 group-hover:scale-105"},null,8,et)),[[d,c.stream_icon]]):(a(),r("div",tt," No Art ")),t("button",{type:"button",onClick:H(T=>j(G)(c.stream_id),["stop"]),class:"absolute top-1 right-1 z-10 rounded-full bg-slate-900/80 p-1 shadow border border-slate-700/80 hover:border-amber-400"},[t("span",{class:E(["text-[11px]",j(W)(c.stream_id)?"text-amber-400":"text-slate-400"])}," ★ ",2)],8,st),p(c)>0?(a(),r("div",{key:2,class:E(["absolute top-1 left-1 text-[10px] font-semibold px-1.5 py-0.5 rounded-full shadow",q(p(c))])}," ★ "+f(p(c).toFixed(1)),3)):m("",!0),e[14]||(e[14]=t("div",{class:"absolute inset-x-0 bottom-0 h-16 bg-gradient-to-t from-black/80 via-black/20 to-transparent pointer-events-none"},null,-1))]),t("div",ot,[t("p",at,f(c.name),1)])]),_:2},1032,["to"]))),128))])])]))),128))])):_.value?m("",!0):(a(),r("p",lt,"No movies available."))])])}}});export{xt as default};
