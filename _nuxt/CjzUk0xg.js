import{_ as $}from"./DQu6aDY2.js";import{g as L,x as B,m as d,r as f,p as F,c as o,a as s,b as j,w as q,q as y,y as I,t as r,j as n,d as v,o as a}from"./DDdGTNQA.js";import{u as S}from"./CDZBQwIF.js";import{u as D}from"./CLStg_Nh.js";import{u as P}from"./B-RZKRZT.js";import{u as z}from"./DlcP7OL2.js";const M={class:"min-h-screen bg-slate-950 text-slate-50"},O={class:"max-w-6xl mx-auto px-4 py-4"},Q={class:"flex items-center justify-between mb-4"},X={class:"flex items-center gap-3"},A={class:"text-xs text-slate-400"},E={class:"grid gap-6 lg:grid-cols-[2fr,1fr] items-start"},G={class:"w-full bg-gradient-to-br from-slate-900 to-slate-800 rounded-2xl overflow-hidden border border-slate-800 mb-3 p-4 flex flex-col gap-3"},H={class:"flex flex-wrap items-center gap-3 mt-1"},J=["href"],K={key:0},W={key:1},Y={key:2},Z={key:0,class:"text-xs text-slate-500 mt-1"},ee={key:1,class:"mt-3 text-[11px] text-slate-500 break-all max-h-24 overflow-y-auto"},te={key:0,class:"mt-4 inline-flex items-center gap-4 rounded-2xl border border-slate-800 bg-slate-900/70 px-4 py-3"},se=["src"],oe={key:1,class:"text-red-400 text-sm mt-4"},ae={key:2,class:"text-slate-400 text-sm mt-2"},le={class:"space-y-3"},ne={class:"flex gap-3"},re=["src","alt"],ie={class:"text-xl font-semibold leading-tight"},ue={key:0,class:"text-sm text-slate-400"},de={key:1,class:"text-xs text-slate-500 mt-1"},ce={key:0,class:"text-sm text-slate-300 space-y-1"},ve={key:0},me={key:1},pe={key:2},xe={key:3},fe={key:4,class:"pt-2 text-slate-200 text-sm"},Ne=L({__name:"[id]",setup(_e){const N=B(),u=d(()=>N.params.id),{addRecent:V}=S(),{xtreamFetch:R}=D(),{creds:m}=P(),{isFavourite:b,toggleFavourite:T}=z(),_=f(!0),p=f(null),e=f(null),h=d(()=>m.value?m.value.serverUrl.replace(/\/+$/,""):"");F(async()=>{_.value=!0,p.value=null;try{const l=await R({action:"get_vod_info",vod_id:u.value});console.log("[movie] get_vod_info response:",l),e.value=l,V(Number(u.value))}catch(l){console.error("[movie] error loading movie:",l),p.value=l?.message||"Unable to load this movie."}finally{_.value=!1}});const g=d(()=>e.value?.info?.name||"Movie"),k=d(()=>{const l=e.value?.info?.name;if(!l)return"";const t=l.match(/\((\d{4})\)/);return t?t[1]:""}),w=d(()=>e.value?.info?.movie_image||e.value?.info?.cover),i=d(()=>{const l=e.value?[e.value?.info?.movie_url,e.value?.info?.direct_source,e.value?.movie_data?.movie_url,e.value?.movie_data?.direct_source].filter(x=>typeof x=="string"&&x.length>0):[];if(l.length)return l[0];if(!m.value||!h.value)return null;const t=e.value?.movie_data?.container_extension||e.value?.info?.container_extension||"mkv";return`${h.value}/movie/${m.value.username}/${m.value.password}/${u.value}.${t}`}),C=d(()=>{if(!i.value)return null;const l="https://api.qrserver.com/v1/create-qr-code/",t=`?size=200x200&data=${encodeURIComponent(i.value)}`;return l+t}),c=f("idle"),U=async()=>{if(i.value)try{await navigator.clipboard.writeText(i.value),c.value="copied",setTimeout(()=>{c.value="idle"},2e3)}catch(l){console.error("clipboard error",l),c.value="error",setTimeout(()=>{c.value="idle"},2e3)}};return(l,t)=>{const x=$;return a(),o("div",M,[s("div",O,[s("div",Q,[s("div",X,[j(x,{to:"/iptv/movies",class:"text-sm text-sky-300 hover:text-sky-200 underline underline-offset-2"},{default:q(()=>[...t[1]||(t[1]=[v(" ← Back to movies ",-1)])]),_:1}),s("button",{type:"button",onClick:t[0]||(t[0]=ye=>y(T)(Number(u.value))),class:"px-2 py-1 rounded-full text-xs border border-slate-700 bg-slate-900/70 flex items-center gap-1"},[s("span",{class:I(["text-sm",y(b)(Number(u.value))?"text-amber-400":"text-slate-400"])}," ★ ",2),s("span",null,r(y(b)(Number(u.value))?"Favourited":"Favourite"),1)])]),s("p",A,"Stream ID: "+r(u.value),1)]),s("div",E,[s("div",null,[s("div",G,[t[2]||(t[2]=s("p",{class:"text-sm text-slate-200"}," This page is a launcher. Use the button below to open the stream in any external player installed on your device (VLC, IPTV app, etc.). Browser playback isn’t supported for this provider. ",-1)),s("div",H,[i.value?(a(),o("a",{key:0,href:i.value,target:"_blank",rel:"noopener",class:"inline-flex items-center justify-center px-4 py-2 rounded-full bg-sky-600 hover:bg-sky-500 text-xs font-semibold text-white shadow-sm"}," Open in external player ",8,J)):n("",!0),i.value?(a(),o("button",{key:1,type:"button",onClick:U,class:"inline-flex items-center justify-center px-3 py-2 rounded-full border border-slate-600 bg-slate-900/80 text-xs text-slate-100 hover:border-sky-500"},[c.value==="idle"?(a(),o("span",K,"Copy URL")):c.value==="copied"?(a(),o("span",W,"Copied!")):(a(),o("span",Y,"Copy failed"))])):n("",!0)]),i.value?n("",!0):(a(),o("p",Z," No external URL could be generated for this movie. ")),i.value?(a(),o("p",ee,r(i.value),1)):n("",!0)]),C.value?(a(),o("div",te,[s("img",{src:C.value,alt:"Stream QR code",class:"w-24 h-24 rounded bg-white p-1"},null,8,se),t[3]||(t[3]=s("div",{class:"text-xs text-slate-300 max-w-xs"},[s("p",{class:"font-semibold text-slate-100 mb-1"},"Scan on another device"),s("p",null," Open your camera or QR app on a TV/phone and scan this code to open the stream in an IPTV player or VLC on that device. ")],-1))])):n("",!0),p.value?(a(),o("p",oe,r(p.value),1)):n("",!0),_.value&&!p.value?(a(),o("p",ae," Loading movie… ")):n("",!0)]),s("aside",le,[s("div",ne,[w.value?(a(),o("img",{key:0,src:w.value,alt:g.value,class:"w-24 h-32 rounded-lg object-cover border border-slate-700"},null,8,re)):n("",!0),s("div",null,[s("h1",ie,r(g.value),1),k.value?(a(),o("p",ue,r(k.value),1)):n("",!0),e.value?.info?.releasedate?(a(),o("p",de," Released: "+r(e.value.info.releasedate),1)):n("",!0)])]),e.value?.info?(a(),o("div",ce,[e.value.info.genre?(a(),o("p",ve,[t[4]||(t[4]=s("span",{class:"font-medium text-slate-400"},"Genre:",-1)),v(" "+r(e.value.info.genre),1)])):n("",!0),e.value.info.duration?(a(),o("p",me,[t[5]||(t[5]=s("span",{class:"font-medium text-slate-400"},"Duration:",-1)),v(" "+r(e.value.info.duration),1)])):n("",!0),e.value.info.director?(a(),o("p",pe,[t[6]||(t[6]=s("span",{class:"font-medium text-slate-400"},"Director:",-1)),v(" "+r(e.value.info.director),1)])):n("",!0),e.value.info.actors?(a(),o("p",xe,[t[7]||(t[7]=s("span",{class:"font-medium text-slate-400"},"Cast:",-1)),v(" "+r(e.value.info.actors),1)])):n("",!0),e.value.info.plot?(a(),o("p",fe,[t[8]||(t[8]=s("span",{class:"block font-medium text-slate-400 mb-1"},"Plot",-1)),v(" "+r(e.value.info.plot),1)])):n("",!0)])):n("",!0)])])])])}}});export{Ne as default};
